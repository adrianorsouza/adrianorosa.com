<!DOCTYPE html>
<html lang="pt-br">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Como alterar o collate do SQL Server | Adriano Rosa</title>
    <meta name="description" content="Algumas vezes, durante a migração de uma base de dados ou na exportação de alguns dados para uma base de outro servidor, podemos ter certos problemas com acentuação. Isto ocorre se os dados da base de origem forem armazenados com seu collate (formato) diferentes da base de destino, ou seja, se temos uma base com seu collate em Latin1GeneralCI_AI e exportarmos seus dados para uma outra base no qual o collate definido seja diferente a acentuação destes registros ficarão de forma truncada.
">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Adriano Rosa">
    <link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
    <link rel="icon" href="/images/favicon.png">
    <link rel="stylesheet" href="/assets/css/application-style.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600">
    <!--[if IE]><script src="/assets/js/ie10-viewport.js"></script><![endif]-->
    <!--[if lt IE 9]>
      <script src="/assets/js/html5shiv.min.js"></script>
      <script src="/assets/js/respond.min.js"></script>
    <![endif]-->
    <link rel='prev' href='http://adrianorosa.com/blog/tecnologia/comecaram-as-votacoes-do-peixe-grande.html' />
    <link rel='next' href='http://adrianorosa.com/blog/banco-de-dados/como-copiar-estrutura-de-tabelas-no-sql-server.html' />
    <link rel="canonical" href="http://adrianorosa.com/blog/banco-de-dados/como-alterar-o-collate-do-sql-server.html" />
    <link rel="alternate" type="application/rss+xml" title="Adriano Rosa &raquo; Feed" href="http://adrianorosa.com/feed.xml" />
    <!-- OpenGraphic tags -->
    <meta property="og:locale" content="pt-br" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Como alterar o collate do SQL Server" />
    <meta property="og:description" content="Algumas vezes, durante a migração de uma base de dados ou na exportação de alguns dados para uma base de outro servidor, podemos ter certos problemas com acentuação. Isto ocorre se os dados da base de origem forem armazenados com seu collate (formato) diferentes da base de destino, ou seja, se temos uma base com seu collate em Latin1GeneralCI_AI e exportarmos seus dados para uma outra base no qual o collate definido seja diferente a acentuação destes registros ficarão de forma truncada.
" />
    <meta property="og:url" content="http://adrianorosa.com/blog/banco-de-dados/como-alterar-o-collate-do-sql-server.html" />
    <meta property="og:site_name" content="Adriano Rosa" />
    <meta property="article:author" content="Adriano Rosa" />
    <meta property="og:image" content="http://adrianorosa.com/images/logo.png" />
  </head>
  <body>
    <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/" title="Adriano Rosa">adriano<strong>rosa</strong></a>
        </div>
        <nav class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/" title="Home">Home</a></li>
            <li><a href="/about/" title="About">Sobre</a></li>
            <li class="active"><a href="/blog/" title="Artigos no Blog">Blog</a></li>
          </ul>
        </nav><!--/.nav-collapse -->
      </div>
    </div>
    <!-- /.header -->
    <div class="blog-header">
      <div class="container">
          <h1 class="blog-title">
                  Banco de Dados
          </h1>
      </div>
    </div>
    <div class="container">
      <div class="row">
          <div class="col-sm-8 content">
<article class="post">
  <header class="post-header">
<h1 class="post-title">Como alterar o collate do SQL Server</h1>
<p class="post-meta">
<time class="post-time" datetime="2008-10-14"><i class="ico ico-clock"></i> 14 Oct 2008</time> &mdash;
<span class="post-category">
<a href="/blog/category/banco-de-dados" title="Artigos na Categoria Banco de Dados">Banco de Dados</a>
</span> &mdash;
<i class="ico ico-comment"></i> <a href="http://adrianorosa.com/blog/banco-de-dados/como-alterar-o-collate-do-sql-server.html#disqus_thread" title="Comentário">0 Comentário</a>
</p>
</header>
  <section class="post-content">
    <p>Algumas vezes, durante a migração de uma base de dados ou na exportação de alguns dados para uma base de outro servidor, podemos ter certos problemas com acentuação. Isto ocorre se os dados da base de origem forem armazenados com seu collate (formato) diferentes da base de destino, ou seja, se temos uma base com seu collate em Latin1<em>General</em>CI_AI e exportarmos seus dados para uma outra base no qual o collate definido seja diferente a acentuação destes registros ficarão de forma truncada.</p>
<p><strong>Vejamos um exemplo</strong><br>
A palavra &quot;Nova Zelândia&quot; foi registrada no banco com collate em <code>Latin1_General_CI_AI</code> . Ao exportamos estes dados para uma outra base onde o collate padrão seja <code>SQL_Latin1_General_CP850_CI_AI</code>, iremos visualizar a mesma palavra desta forma &quot;Nova Zel?ndia&quot;.</p>
<p>Você pode evitar esse tipo de transtorno antes de exportar ou migrar os dados, mas antes verifique o collate da base de destino, executando o comando:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">SP_HELPDB
</code></pre></div>
<p>No assistente Query Analizer, na a coluna status poderá ser visto o collate que está sendo usado,</p>
<p><img class="size-full wp-image-40" title="sql1" src="/images/2011/04/sql1.jpg" alt="sql1" width="480" height="228" /></p>
<p>Para alterar o collate padrão da base, precisamos antes ajustar o banco para o modo <code>SINGLE_USER</code>, caso contrário teremos a mensagem de erro:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">The database could not be exclusively locked to perform the operation.
</code></pre></div>
<p>Veja os comandos:</p>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">ALTER</span> <span class="k">DATABASE</span> <span class="n">NOMEBANCO</span> <span class="k">SET</span> <span class="n">SINGLE_USER</span> <span class="k">WITH</span> <span class="k">ROLLBACK</span> <span class="k">IMMEDIATE</span>
<span class="k">ALTER</span> <span class="k">DATABASE</span> <span class="n">NOMEBANCO</span> <span class="k">COLLATE</span> <span class="n">NOVO_COLLATION</span>
<span class="k">ALTER</span> <span class="k">DATABASE</span> <span class="n">NOMEBANCO</span> <span class="k">SET</span> <span class="n">MULTI_USER</span></code></pre></div>
<p>Explicando o código:</p>
<p>1º linha altera o banco para o modo <code>single_user</code><br>
2º linha modifica o <code>Collate</code> para <code>Latin1_General_CI_AI</code><br>
3º linha é redefinido o banco para o modo <code>multi_user</code>  </p>
<p>Executando no <em>Query Analizer</em> teremos assim:</p>
<p><img class="size-full wp-image-41" title="sql2" src="/images/2011/04/sql2.jpg" alt="sql2" width="490" height="283" /></p>
<p>A mensagem: </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Nonqualified transactions are being rolled back. Estimated rollback completion: 100%.
</code></pre></div>
<p>Significa que o procedimento foi efetuado com sucesso.</p>
<p>Agora é possível exportar ou migrar os dados de uma base para outra sem que tenhamos problemas com acentuação.</p>
<p>Lembrando que este procedimento irá alterar o collate do banco de dados. Na criação de novas tabelas estará com o novo collation definido, porém as tabelas já existentes permanecerão com o collation anterior.</p>
  </section><!-- ./post-content -->
  <hr>
  <section class="post-related">
    <h3>Post relacionados</h3>
    <ol class="list-unstyled">
      <li><time class="post-time" datetime="2014-09-01">01 Sep 2014</time> &mdash; <a href="/blog/aws/criar-instancia-na-amazon-aws.html" title="Criar uma instancia na Amazon AWS">Criar uma instancia na Amazon AWS</a></li>
      <li><time class="post-time" datetime="2008-11-10">10 Nov 2008</time> &mdash; <a href="/blog/wordpress/como-instalar-o-wordpress.html" title="Como instalar o WordPress">Como instalar o WordPress</a></li>
      <li><time class="post-time" datetime="2014-09-03">03 Sep 2014</time> &mdash; <a href="/blog/linux/configurar-webserver-linux-ubuntu-php-e-apache-nginx.html" title="Como configurar um servidor web Linux Ubuntu">Como configurar um servidor web Linux Ubuntu</a></li>
    </ol>
  </section><!-- ./post-related -->
  <hr>
  <section class="post-navigation">
    <ul class="pager">
      <li class="prev"><a href="/blog/tecnologia/comecaram-as-votacoes-do-peixe-grande.html" title="Começaram as votações do Peixe Grande">&lsaquo; anterior</a></li>
      <li class="next"><a href="/blog/banco-de-dados/como-copiar-estrutura-de-tabelas-no-sql-server.html" title="Como copiar estrutura de tabelas no SQL Server">próximo &rsaquo;</a></li>
    </ul>
  </section><!-- ./post-navigation -->
  <section class="post-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'adrianorosa';
        var disqus_title = 'Como alterar o collate do SQL Server';
        var disqus_url = 'http://adrianorosa.com/blog/banco-de-dados/como-alterar-o-collate-do-sql-server.html';
        var disqus_identifier = '39 http://adrianorosa.com/?p=39';
        // var disqus_developer = 1; // developer mode is on
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </section>
<script type="text/javascript">
  var disqus_shortname = 'adrianorosa';
  (function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>
</article>
          </div><!-- /.content -->
<aside class="col-sm-3 col-sm-offset-1 blog-sidebar">
  <div class="sidebar-module sidebar-module-inset author-brief">
    <h4><img src="https://secure.gravatar.com/avatar/ad6facb479066db3b8007443ce79fcdd?s=100" alt="" class="img-circle" width="50" height="50"> Sobre o Adriano</h4>
    <p>
      Adriano é Desenvolvedor Web há oito anos. Apaixonado pelo o que faz!
      Ao longo de todos esses anos se especializou em diversas tecnologias de desenvolvimento web,
      hoje é considerado FullStack Developer.
    </p>
    <hr>
    <ul>
      <li><a href="https://github.com/adrianorsouza" class="_blank" title="veja meu perfil no Github"><i class="ico ico-github"></i> <span class="hide-text">GitHub</span></a></li>
      <li><a href="https://twitter.com/adrianorosa" class="_blank" title="veja meu perfil no Twitter"><i class="ico ico-twitter"></i> <span class="hide-text">Twitter</span></a></li>
      <li><a href="https://www.facebook.com/adrianorosadesouza" class="_blank" title="veja meu perfil no Facebook"><i class="ico ico-facebook"></i> <span class="hide-text">Facebook</span></a></li>
      <li><a href="/feed.xml" class="_blank" title="acompanhe as atualizações do blog"><i class="ico ico-rss"></i> <span class="hide-text">Rss</span></a></li>
    </ul>
  </div>
  <div class="sidebar-module">
    <h4>Categorias</h4>
    <ol class="list-unstyled">
      <li><a href="/blog/category/asp" title="ASP">ASP</a></li>
      <li><a href="/blog/category/aws" title="AWS">AWS</a></li>
      <li class="active"><a href="/blog/category/banco-de-dados" title="Banco de Dados">Banco de Dados</a></li>
      <li><a href="/blog/category/css" title="CSS">CSS</a></li>
      <li><a href="/blog/category/composer" title="Composer">Composer</a></li>
      <li><a href="/blog/category/google" title="Google">Google</a></li>
      <li><a href="/blog/category/laravel" title="Laravel">Laravel</a></li>
      <li><a href="/blog/category/linux" title="Linux">Linux</a></li>
      <li><a href="/blog/category/nginx" title="Nginx">Nginx</a></li>
      <li><a href="/blog/category/noticias" title="Noticias">Noticias</a></li>
      <li><a href="/blog/category/ruby" title="Ruby">Ruby</a></li>
      <li><a href="/blog/category/seguranca" title="Segurança">Segurança</a></li>
      <li><a href="/blog/category/sublime-text" title="Sublime Text">Sublime Text</a></li>
      <li><a href="/blog/category/tecnologia" title="Tecnologia">Tecnologia</a></li>
      <li><a href="/blog/category/wordpress" title="Wordpress">Wordpress</a></li>
      <li><a href="/blog/category/jquery" title="jQuery">jQuery</a></li>
    </ol>
  </div>
</aside><!-- /.blog-sidebar -->
      </div><!-- /.row -->
    </div><!-- /.container -->
    <footer class="blog-footer">
      <p>Adriano Rosa - Web Developer</p>
      <ol class="list-unstyled">
        <li><a href="https://github.com/adrianorsouza" class="_blank"><i class="ico ico-github"></i> GitHub</a></li>
        <li><a href="https://twitter.com/adrianorosa" class="_blank"><i class="ico ico-twitter"></i> Twitter</a></li>
        <li><a href="https://www.facebook.com/adrianorosadesouza" class="_blank"><i class="ico ico-facebook"></i> Facebook</a></li>
      </ol>
      <p><small>This blog is proudly built with <a href="http://jekyllrb.com/" class="_blank">Jekyll</a> | &copy; 2005 &mdash; 2016</small></p>
    </footer>
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/main.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-5189486-5', 'auto');
  ga('send', 'pageview');
</script>
<a href="#top" class="btn to_top" title="rolar a página"><i class="ico ico-arrow-up"></i></a>

  </body>
</html>
