<!DOCTYPE html>
<html lang="pt-br">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Instalar NGINX no OSX Mavericks | Adriano Rosa</title>
    <meta name="description" content="Esse post é um guia passo a passo para compilar e instalar o Nginx no Mac OSX Mavericks. Existem outros meios para instalar o Nginx usando package manager por ex. o Homebrew ou MacPorts, no Mountain Lion utilizava o Homebrew, no entanto, não tenho mais feito o uso de package manager pois eles instalam uma tonelada de códigos arbitrários no sistema e ambos dependem do Xcode para sua execução, então não vejo mais a necessidade uma vez que é possível customizar e compilar qualquer programa facilmente só com Xcode e Command Line Tools instalado.
">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Adriano Rosa">
    <link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
    <link rel="icon" href="/images/favicon.png">
    <link rel="stylesheet" href="/assets/css/application-style.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600">
    <!--[if IE]><script src="/assets/js/ie10-viewport.js"></script><![endif]-->
    <!--[if lt IE 9]>
      <script src="/assets/js/html5shiv.min.js"></script>
      <script src="/assets/js/respond.min.js"></script>
    <![endif]-->
    <link rel='prev' href='http://adrianorosa.com/blog/ruby/upgrade-ruby-no-mac-osx-via-homebrew.html' />
    <link rel='next' href='http://adrianorosa.com/blog/sublime-text/sidebar-icones-suporte-sublime-text-3-soda-theme.html' />
    <link rel="canonical" href="http://adrianorosa.com/blog/nginx/instalar-nginx-no-osx-mavericks.html" />
    <link rel="alternate" type="application/rss+xml" title="Adriano Rosa &raquo; Feed" href="http://adrianorosa.com/feed.xml" />
    <!-- OpenGraphic tags -->
    <meta property="og:locale" content="pt-br" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Instalar NGINX no OSX Mavericks" />
    <meta property="og:description" content="Esse post é um guia passo a passo para compilar e instalar o Nginx no Mac OSX Mavericks. Existem outros meios para instalar o Nginx usando package manager por ex. o Homebrew ou MacPorts, no Mountain Lion utilizava o Homebrew, no entanto, não tenho mais feito o uso de package manager pois eles instalam uma tonelada de códigos arbitrários no sistema e ambos dependem do Xcode para sua execução, então não vejo mais a necessidade uma vez que é possível customizar e compilar qualquer programa facilmente só com Xcode e Command Line Tools instalado.
" />
    <meta property="og:url" content="http://adrianorosa.com/blog/nginx/instalar-nginx-no-osx-mavericks.html" />
    <meta property="og:site_name" content="Adriano Rosa" />
    <meta property="article:author" content="Adriano Rosa" />
    <meta property="og:image" content="http://adrianorosa.com/images/logo.png" />
  </head>
  <body>
    <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/" title="Adriano Rosa">adriano<strong>rosa</strong></a>
        </div>
        <nav class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/" title="Home">Home</a></li>
            <li><a href="/about/" title="About">Sobre</a></li>
            <li class="active"><a href="/blog/" title="Artigos no Blog">Blog</a></li>
          </ul>
        </nav><!--/.nav-collapse -->
      </div>
    </div>
    <!-- /.header -->
    <div class="blog-header">
      <div class="container">
          <h1 class="blog-title">
                  Nginx
          </h1>
      </div>
    </div>
    <div class="container">
      <div class="row">
          <div class="col-sm-8 content">
<article class="post">
  <header class="post-header">
<h1 class="post-title">Instalar NGINX no OSX Mavericks</h1>
<p class="post-meta">
<time class="post-time" datetime="2014-08-05"><i class="ico ico-clock"></i> 05 Aug 2014</time> &mdash;
<span class="post-category">
<a href="/blog/category/nginx" title="Artigos na Categoria Nginx">Nginx</a>
</span> &mdash;
<i class="ico ico-comment"></i> <a href="http://adrianorosa.com/blog/nginx/instalar-nginx-no-osx-mavericks.html#disqus_thread" title="Comentário">0 Comentário</a>
</p>
</header>
  <section class="post-content">
    <p>Esse post é um guia passo a passo para compilar e instalar o <a href="http://nginx.org/">Nginx</a> no Mac OSX Mavericks. Existem outros meios para instalar o Nginx usando <em>package manager</em> por ex. o <a href="http://brew.sh/">Homebrew</a> ou <a href="https://www.macports.org/">MacPorts</a>, no Mountain Lion utilizava o Homebrew, no entanto, não tenho mais feito o uso de <em>package manager</em> pois eles instalam uma tonelada de códigos arbitrários no sistema e ambos dependem do <strong>Xcode</strong> para sua execução, então não vejo mais a necessidade uma vez que é possível customizar e compilar qualquer programa facilmente só com Xcode e Command Line Tools instalado.</p>
<h2 id="requisitos">Requisitos</h2>
<ul>
<li><a href="http://itunes.apple.com/us/app/xcode/id497799835?ls=1&amp;mt=12">XCode</a> com Command Line Tools instalado.</li>
</ul>
<p>Baixe e instale o XCode e após sua instalação é preciso instalar Command Line Tools executando o seguinte comando no terminal:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">xcode-select --install
</code></pre></div>
<p>Geralmente arquivos de programas instalados pelo usuário são salvos no diretório <code>/usr/local</code> e para o download dos sources vou utilizar o diretório <code>usr/local/src</code>. Se esses diretórios não existir crie e altere as permissões para seu usuário.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo mkdir -p /usr/local
sudo mkdir -p /usr/local/src
sudo chown -R $USER:staff /usr/local
</code></pre></div>
<h2 id="instalar-o-nginx">Instalar o nginx</h2>
<p>Nesse post vou utilizar a versão 1.6.1 do Nginx mais recente e estável mas o procedimento é o mesmo para versões anteriores ou posterior.</p>
<h3 id="detalhes-da-instalação:">Detalhes da instalação:</h3>
<p><strong>Link:</strong> <a href="http://nginx.org">http://nginx.org</a><br>
<strong>Versão:</strong> 1.6.1<br>
<strong>Dependências:</strong><br></p>
<ol>
<li><strong>PCRE</strong>: 
<ul>
<li>Link: <a href="http://www.pcre.org">http://www.pcre.org</a><br></li>
<li>Versão: 8.33 </li>
<li>Detalhes: Essa library é requisito para suporte as expressões regulares.</li>
</ul></li>
<li><strong>ZLIB</strong>:
<ul>
<li>Link: <a href="http://zlib.net:">http://zlib.net:</a></li>
<li>Versão: 1.2.8<br></li>
<li>Detalhes: Essa library é requisito para o <code>ngx_http_gzip_module</code> módulo.</li>
</ul></li>
</ol>
<blockquote>
<p>As dependencias não precisam ser compiladas e instaladas separadamente, basta desempacotar os arquivos e dizer ao Nginx durante o <a href="http://en.wikipedia.org/wiki/Compile_time">Compiler Time</a> o Nginx faz o restante do serviço.</p>
</blockquote>
<h3 id="baixar-os-sources:">Baixar os sources:</h3>
<p>Abra o terminal e altere o diretório</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd /usr/local/src
</code></pre></div>
<p><strong>Download PCRE</strong></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">curl -OL ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.33.tar.gz 
tar -xvzf pcre-8.33.tar.gz 
</code></pre></div>
<p><strong>Download ZLIB</strong></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">curl -OL http://zlib.net/zlib-1.2.8.tar.gz
tar -xvzf zlib-1.2.8.tar.gz
</code></pre></div>
<p><strong>Download NGINX v1.6.1 stable</strong></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">curl -OL http://nginx.org/download/nginx-1.6.1.tar.gz
tar -zvxf nginx-1.6.1.tar.gz    
</code></pre></div>
<p><strong>Compilar e instalar nginx</strong></p>
<p>Altere para o diretório do nginx sources:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">cd nginx-1.6.1
</code></pre></div>
<blockquote>
<p>NOTA: O nginx deve ser configurado e instalado usando o usuário <code>root</code> caso contrário poderá ocorrer alguns problemas durante o <a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man1/launchctl.1.html#//apple_ref/doc/man/1/launchctl">processo de inicialização</a> nesse caso vamos usar <code>sudo</code></p>
</blockquote>
<p>Customizar a instalação passando os devidos parâmetros para o comando <code>./configure</code>.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo ./configure \
--prefix=/usr/local/nginx-1.6.1 \
--conf-path=/usr/local/nginx-1.6.1/conf/nginx.conf \
--http-log-path=/var/log/nginx-access.log \
--error-log-path=/var/log/nginx-error.log \
--user=_www \
--group=_www \
--with-http_ssl_module \
--with-http_realip_module \
--with-http_addition_module \
--with-http_sub_module \
--with-http_dav_module \
--with-http_flv_module \
--with-http_mp4_module \
--with-http_gunzip_module \
--with-http_gzip_static_module \
--with-http_random_index_module \
--with-http_secure_link_module \
--with-http_stub_status_module \
--with-http_auth_request_module \
--with-mail \
--with-mail_ssl_module \
--with-http_spdy_module \
--with-ipv6 \
--with-http_xslt_module \
--with-pcre=../pcre-8.33 \
--with-zlib=../zlib-1.2.8 \
--with-cc-opt=-Wno-deprecated-declarations
</code></pre></div>
<p>Compilar e Instalar </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">make
make install
</code></pre></div>
<h2 id="pós-instalação">Pós Instalação</h2>
<p>Criar symlink apontando para <code>/usr/local/nginx</code>.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ln -sv /usr/local/nginx-1.6.1 /usr/local/nginx 
</code></pre></div>
<p>Adicionar nginx ao PATH</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">echo &#39;export PATH=/usr/local/nginx/sbin:$PATH&#39; &gt;&gt; ~/.bash_profile
</code></pre></div>
<p>Reload bash</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">source ~/.bash_profile
</code></pre></div>
<p>Verificar a instalação do nginx</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">nginx -v
</code></pre></div>
<p>Deverá ser exibido:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"># nginx version: nginx/1.6.1    
</code></pre></div>
<p>Iniciar o nginx</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo nginx
</code></pre></div>
<h2 id="autoload-nginx-durante-a-inicialização-do-sistema.">Autoload nginx durante a inicialização do sistema.</h2>
<p>Crie uma plist <code>com.nginx.nginx.plist</code> no diretório <code>/Library/LaunchDaemons</code>.  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo nano /Library/LaunchDaemons/com.nginx.nginx.plist
</code></pre></div>
<p>Conteúdo da plist: </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
    &lt;key&gt;Label&lt;/key&gt;
    &lt;string&gt;com.nginx.nginx&lt;/string&gt;
    &lt;key&gt;ProgramArguments&lt;/key&gt;
      &lt;array&gt;
        &lt;string&gt;/usr/local/nginx/sbin/nginx&lt;/string&gt;
        &lt;string&gt;-c&lt;/string&gt;
        &lt;string&gt;/usr/local/nginx/conf/nginx.conf&lt;/string&gt;
      &lt;/array&gt;
    &lt;key&gt;KeepAlive&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;LaunchOnlyOnce&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre></div>
<p>Esta plist auto inicia o nginx durante o system startup.</p>
<p><strong>Testar a plist durante o system startup:</strong>  </p>
<blockquote>
<p>NOTA: O processo nginx deve ser finalizado para executar a plist.</p>
</blockquote>
<p>Comando para finalizar processo nginx antes de carregar a plist:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo nginx -s stop
</code></pre></div>
<p>Testar auto-start nginx com a recém criada plist:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo launchctl load /Library/LaunchDaemons/com.nginx.nginx.plist
</code></pre></div>
<p>Comando para verificar se o processo do nginx foi corretamente inicializado:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ps axw -o pid,ppid,user,%cpu,command | egrep &#39;(nginx|PID)&#39;
</code></pre></div>
<p>Deverá exibir algo como:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">  PID  PPID USER             %CPU COMMAND
29733     1 root              0.0 nginx: master process /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf  
29784 29733 _www              0.0 nginx: worker process  
29785 29733 _www              0.0 nginx: worker process  
29786 29733 _www              0.0 nginx: worker process     
30007 28694 username          0.0 egrep (nginx|PID)
</code></pre></div>
<p>Recarregar o nginx processo:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo nginx -s reload
</code></pre></div>
<blockquote>
<p>NOTA: A PLIST tem a função de iniciar o processo nginx uma vez durante a inicialização do sistema. Se tentar executar a plist mais de uma vez o seguinte erro pode acontecer:</p>
</blockquote>
<div class="highlight"><pre><code class="language-text" data-lang="text">[emerg] 29763#0: bind() to 0.0.0.0:80 failed (48: Address already in use)
</code></pre></div>
<p>Se precisar que o nginx carregue alterações feitas nos arquivos de configuração a melhor maneira de fazer o reload do nginx é através do comando <code>sudo nginx -s reload</code> como mencionado anteriormente.</p>
  </section><!-- ./post-content -->
  <hr>
  <section class="post-related">
    <h3>Post relacionados</h3>
    <ol class="list-unstyled">
      <li><time class="post-time" datetime="2014-09-03">03 Sep 2014</time> &mdash; <a href="/blog/linux/configurar-webserver-linux-ubuntu-php-e-apache-nginx.html" title="Como configurar um servidor web Linux Ubuntu">Como configurar um servidor web Linux Ubuntu</a></li>
      <li><time class="post-time" datetime="2014-09-01">01 Sep 2014</time> &mdash; <a href="/blog/aws/criar-instancia-na-amazon-aws.html" title="Criar uma instancia na Amazon AWS">Criar uma instancia na Amazon AWS</a></li>
      <li><time class="post-time" datetime="2014-11-28">28 Nov 2014</time> &mdash; <a href="/blog/nginx/instalar-versao-recente-nginx-no-linux-ubuntu.html" title="Instalar versão mais recente do Nginx no Linux Ubuntu">Instalar versão mais recente do Nginx no Linux Ubuntu</a></li>
    </ol>
  </section><!-- ./post-related -->
  <hr>
  <section class="post-navigation">
    <ul class="pager">
      <li class="prev"><a href="/blog/ruby/upgrade-ruby-no-mac-osx-via-homebrew.html" title="Upgrade Ruby no Mac OSX via Homebrew">&lsaquo; anterior</a></li>
      <li class="next"><a href="/blog/sublime-text/sidebar-icones-suporte-sublime-text-3-soda-theme.html" title="Sidebar Icons Suporte Sublime Text 3 para o Soda Theme">próximo &rsaquo;</a></li>
    </ul>
  </section><!-- ./post-navigation -->
  <section class="post-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'adrianorosa';
        var disqus_title = 'Instalar NGINX no OSX Mavericks';
        var disqus_url = 'http://adrianorosa.com/blog/nginx/instalar-nginx-no-osx-mavericks.html';
        var disqus_identifier = '';
        // var disqus_developer = 1; // developer mode is on
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </section>
<script type="text/javascript">
  var disqus_shortname = 'adrianorosa';
  (function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>
</article>
          </div><!-- /.content -->
<aside class="col-sm-3 col-sm-offset-1 blog-sidebar">
  <div class="sidebar-module sidebar-module-inset author-brief">
    <h4><img src="https://secure.gravatar.com/avatar/ad6facb479066db3b8007443ce79fcdd?s=100" alt="" class="img-circle" width="50" height="50"> Sobre o Adriano</h4>
    <p>
      Adriano é Analista Programador Backend/Frontend por mais de uma década. Apaixonado pelo o que faz!
      Ao longo de todos esses anos se especializou em diversas tecnologias de desenvolvimento web,
      hoje é considerado FullStack Developer.
    </p>
    <hr>
    <ul>
      <li><a href="https://github.com/adrianorsouza" class="_blank" title="veja meu perfil no Github"><i class="ico ico-github"></i> <span class="hide-text">GitHub</span></a></li>
      <li><a href="https://twitter.com/adrianorosa" class="_blank" title="veja meu perfil no Twitter"><i class="ico ico-twitter"></i> <span class="hide-text">Twitter</span></a></li>
      <li><a href="https://www.facebook.com/adrianorosadesouza" class="_blank" title="veja meu perfil no Facebook"><i class="ico ico-facebook"></i> <span class="hide-text">Facebook</span></a></li>
      <li><a href="/feed.xml" class="_blank" title="acompanhe as atualizações do blog"><i class="ico ico-rss"></i> <span class="hide-text">Rss</span></a></li>
    </ul>
  </div>
  <div class="sidebar-module">
    <h4>Categorias</h4>
    <ol class="list-unstyled">
      <li><a href="/blog/category/asp" title="ASP">ASP</a></li>
      <li><a href="/blog/category/aws" title="AWS">AWS</a></li>
      <li><a href="/blog/category/banco-de-dados" title="Banco de Dados">Banco de Dados</a></li>
      <li><a href="/blog/category/css" title="CSS">CSS</a></li>
      <li><a href="/blog/category/composer" title="Composer">Composer</a></li>
      <li><a href="/blog/category/google" title="Google">Google</a></li>
      <li><a href="/blog/category/laravel" title="Laravel">Laravel</a></li>
      <li><a href="/blog/category/linux" title="Linux">Linux</a></li>
      <li class="active"><a href="/blog/category/nginx" title="Nginx">Nginx</a></li>
      <li><a href="/blog/category/noticias" title="Noticias">Noticias</a></li>
      <li><a href="/blog/category/ruby" title="Ruby">Ruby</a></li>
      <li><a href="/blog/category/seguranca" title="Segurança">Segurança</a></li>
      <li><a href="/blog/category/sublime-text" title="Sublime Text">Sublime Text</a></li>
      <li><a href="/blog/category/tecnologia" title="Tecnologia">Tecnologia</a></li>
      <li><a href="/blog/category/webserver" title="Webserver">Webserver</a></li>
      <li><a href="/blog/category/wordpress" title="Wordpress">Wordpress</a></li>
      <li><a href="/blog/category/jquery" title="jQuery">jQuery</a></li>
    </ol>
  </div>
</aside><!-- /.blog-sidebar -->
      </div><!-- /.row -->
    </div><!-- /.container -->
    <footer class="blog-footer">
      <p>Adriano Rosa - Web Developer</p>
      <ol class="list-unstyled">
        <li><a href="https://github.com/adrianorsouza" class="_blank"><i class="ico ico-github"></i> GitHub</a></li>
        <li><a href="https://twitter.com/adrianorosa" class="_blank"><i class="ico ico-twitter"></i> Twitter</a></li>
        <li><a href="https://www.facebook.com/adrianorosadesouza" class="_blank"><i class="ico ico-facebook"></i> Facebook</a></li>
      </ol>
      <p><small>This blog is proudly built with <a href="http://jekyllrb.com/" class="_blank">Jekyll</a> | &copy; 2005 &mdash; 2017</small></p>
    </footer>
<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/main.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-5189486-5', 'auto');
  ga('send', 'pageview');
</script>
<a href="#top" class="btn to_top" title="rolar a página"><i class="ico ico-arrow-up"></i></a>

  </body>
</html>
